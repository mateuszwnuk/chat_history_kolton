:root{
  --bg:#0b0c10;--panel:#121319;--muted:#9aa3af;--text:#e8eaee;--accent:#60a5fa;
  --border:#232839;--border-strong:#2b3246;--chip-human:#34d399;--chip-ai:#f59e0b;--chip-system:#a78bfa;--danger:#ef4444;--good:#2bd576;
  --navbar-h:60px;
}

/* Base */
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;background:var(--bg);color:var(--text);
  font:14px/1.5 system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,sans-serif;
  padding-top: var(--navbar-h); /* kompensacja fixowanej nawigacji */
}

/* Pasek postępu */
.progress-bar{position:fixed;top:0;left:0;height:3px;width:100%;background:transparent;z-index:1000;overflow:hidden;pointer-events:none}
.progress-bar span{position:absolute;top:0;left:-40%;height:100%;width:40%;
  background:linear-gradient(90deg,rgba(96,165,250,0),rgba(96,165,250,.9),rgba(96,165,250,0));
  transform:translateX(0);animation:progress-flow 1.1s linear infinite;opacity:0;transition:opacity .2s ease}
.progress-bar.active span{opacity:1}
@keyframes progress-flow{0%{left:-40%}100%{left:100%}}

/* NAVBAR (fixed) */
.navbar{
  position:fixed; top:0; left:0; right:0; z-index:60;
  display:flex; align-items:center; justify-content:space-between; gap:12px;
  padding:10px 16px; background:rgba(18,19,25,.95); backdrop-filter: blur(6px);
  border-bottom:1px solid var(--border);
}
.nav-left{display:flex; gap:8px; align-items:center}
.brand{font-weight:800; letter-spacing:.02em; margin-right:8px}
.tab{
  background:#0f1117; color:var(--text); border:1px solid var(--border); border-radius:10px; padding:8px 12px; cursor:pointer
}
.tab:hover{border-color:var(--accent)}
.tab.active{border-color:var(--accent); box-shadow:0 0 0 1px rgba(96,165,250,.25) inset}

.nav-controls{
  display:flex; gap:8px; align-items:center; flex-wrap:wrap; justify-content:flex-end; min-width:420px;
}
.nav-controls input[type="checkbox"]{ vertical-align:middle; margin-right:6px }
.bar-sep.h{width:1px; height:26px; background:var(--border); margin:0 4px}

.refresh-hint{ display:inline-flex; align-items:center; gap:6px; background: rgba(43,213,118,0.06); color: var(--good); border:1px solid rgba(43,213,118,0.12); padding:6px 8px; border-radius:999px; font-weight:700 }
.refresh-hint.hidden{ opacity:0; transform: translateY(-2px); transition:opacity .18s, transform .18s; pointer-events:none }
.status-header{ font-size:13px; color:var(--muted) }

/* LAYOUT */
.layout{
  display:grid; grid-template-columns: 330px 1fr; gap:16px;
  padding:16px; min-height:calc(100vh - var(--navbar-h));
}

/* Sidebar (sticky) */
.sidebar{ position:sticky; top: calc(var(--navbar-h) + 16px); align-self:start; height: calc(100vh - var(--navbar-h) - 32px) }
.sidebar-inner{ height:100%; display:flex; flex-direction:column; min-height:0; background:var(--panel); border:1px solid var(--border); border-radius:14px }
.sidebar-header{ padding:12px; border-bottom:1px solid var(--border); display:grid; gap:8px }
.sidebar-header .title{ font-weight:800 }
.sidebar-footer{ padding:10px 12px; border-top:1px solid var(--border) }

/* Lista wątków – zwarta */
.session-list{ display:flex; flex-direction:column; gap:8px; overflow:auto; padding:8px; min-height:0 }
.session-item{
  display:flex; align-items:center; justify-content:space-between; gap:8px;
  background:#0f1117; border:1px solid var(--border); border-radius:10px; padding:8px 10px; cursor:pointer;
  height:auto; min-height:0; line-height:1.25;
}
.session-item:hover{ border-color:var(--accent) }
.session-item.active{ border-color:var(--accent); box-shadow:0 0 0 1px rgba(96,165,250,.25) inset }
.session-item > span{ display:flex; align-items:center; gap:6px }
.session-id{ font-family:ui-monospace,monospace; overflow:hidden; text-overflow:ellipsis; white-space:nowrap; max-width:210px }
.session-bad{ color:var(--danger); font-weight:900; margin-right:4px }
.badge{ font-size:12px; color:#a6b4d9; background:#101628; border:1px solid var(--border-strong); padding:2px 8px; border-radius:999px }

/* Main */
.main{ display:flex; flex-direction:column; gap:12px; min-width:0 }
.card{ background:var(--panel); border:1px solid var(--border); border-radius:14px; padding:12px }
.row{ display:flex; gap:12px; flex-wrap:wrap; align-items:center }
.row>*{ flex:1 1 auto }
input,button,select{ background:#0f1117; color:var(--text); border:1px solid var(--border); border-radius:10px; padding:9px 11px; outline:none }
button{ cursor:pointer; transition:transform .05s ease, border-color .2s ease }
button:hover{ transform:translateY(-1px); border-color:var(--accent) }
button[disabled]{ opacity:.6; cursor:not-allowed }
.toolbar{ display:flex; gap:8px; align-items:center; flex-wrap:wrap }
.grow{ flex:1 1 100% }
.muted{ color:var(--muted) }
.status{ margin:0 4px }

/* Rozmowa */
.conversation{ min-height:280px }
.conv-header{ display:flex; align-items:center; justify-content:space-between; gap:12px; padding-bottom:8px; border-bottom:1px solid var(--border) }
.conv-title{ display:flex; align-items:center; gap:8px }
.flag{ display:inline-flex; align-items:center; gap:6px; color:var(--danger); font-weight:800 }
.flag.hidden{ display:none }
.messages{ padding:12px 0; display:grid; gap:10px }
.msg{ border:1px solid var(--border); border-radius:12px; padding:10px 12px; background:#151b28; display:grid; gap:6px }
.msg .head{ display:flex; gap:8px; align-items:center; justify-content:space-between }
.type{ font-size:11px; text-transform:uppercase; letter-spacing:.06em; font-weight:800; padding:3px 8px; border-radius:999px; border:1px solid var(--border) }
.type.human{ background:rgba(52,211,153,.12); color:var(--chip-human) }
.type.ai{ background:rgba(245,158,11,.12); color:var(--chip-ai) }
.type.system,.type.tool{ background:rgba(167,139,250,.12); color:var(--chip-system) }
.id{ font-size:12px; color:var(--muted) }
pre.content{ margin:0; white-space:pre-wrap; word-break:break-word; font-family:ui-monospace,monospace; background:#0e1422; border:1px solid var(--border); border-radius:10px; padding:10px 12px }

/* KPI / Statystyki */
.kpis{ display:grid; grid-template-columns:repeat(5,minmax(140px,1fr)); gap:12px }
.kpi{ background:#0f1117; border:1px solid var(--border); border-radius:12px; padding:12px }
.kpi-label{ color:var(--muted); font-size:12px }
.kpi-value{ font-size:22px; font-weight:800; margin-top:6px }

/* Wykres – stały kontener */
.chart-wrap{ position:relative; width:100%; height:260px }
.chart-wrap canvas{ display:block; width:100% !important; height:100% !important }

/* Top keywords list */
.keywords-list{ display:flex; flex-direction:column; gap:8px; margin-top:8px }
.keyword-item{ display:flex; justify-content:space-between; align-items:center; background:#0f1117; border:1px solid var(--border); padding:8px 10px; border-radius:10px }
.keyword-item .kw{ font-weight:700; font-family:ui-monospace,monospace }
.keyword-item .kw-count{ color:var(--muted); font-weight:800 }

/* Pływający przycisk „Najnowsze” */
.jump-btn{
  position: fixed; right: 20px; bottom: 24px; z-index: 55;
  background: #0f1117; color: var(--text); border: 1px solid var(--border-strong);
  border-radius: 999px; padding: 10px 14px; box-shadow: 0 6px 20px rgba(0,0,0,.35);
  cursor: pointer; transition: opacity .18s ease, transform .18s ease, border-color .2s ease;
}
.jump-btn:hover{ border-color: var(--accent); transform: translateY(-2px); }
.jump-btn.hidden{ opacity: 0; pointer-events: none; transform: translateY(8px); }
.jump-btn.pulse{ animation: jumpPulse .9s ease-out 1; }
@keyframes jumpPulse{ 0%{box-shadow:0 0 0 0 rgba(96,165,250,.5)} 100%{box-shadow:0 0 0 16px rgba(96,165,250,0)} }

/* Notify badge */
.notify-badge{ display:inline-flex; align-items:center; gap:6px; padding:6px 10px; border:1px solid var(--border-strong); border-radius:999px; background:#101628 }
.dot{ width:8px; height:8px; border-radius:999px; background:var(--good) }
.count{ font-weight:800 }

.hidden{ display:none !important }

/* Responsive */
@media (max-width: 980px){
  .layout{ grid-template-columns:1fr }
  .sidebar{ position:static; height:auto }
  .kpis{ grid-template-columns:repeat(2,minmax(140px,1fr)) }
  .nav-controls{ min-width: auto }
}

/* --- Toast / badge --- */
.toast{
  position: fixed;
  left: 50%;
  bottom: 88px;                 /* nad przyciskiem 'Najnowsze' */
  transform: translateX(-50%);
  z-index: 70;
  background: #101628;
  color: var(--text);
  border: 1px solid var(--border-strong);
  border-radius: 999px;
  padding: 8px 14px;
  box-shadow: 0 8px 24px rgba(0,0,0,.35);
  opacity: 0;
  pointer-events: none;
  transition: opacity .18s ease, transform .18s ease, border-color .2s ease;
}
.toast.show{
  opacity: 1;
  transform: translateX(-50%) translateY(-4px);
}
.toast.ok{ border-color: rgba(43,213,118,.6); }
.toast.warn{ border-color: rgba(245,158,11,.6); }
.toast.err{ border-color: rgba(239,68,68,.7); }
.hidden{ display: none !important; }
